{% extends 'base.html' %} {% block title %}
<title>messages</title>
{% endblock %} {% block body %}
<div class="main-container">

    <div id="bookroom-header">
      <h1>PUBLIC</h1> 
      <div class="message-meta">
      <div id ="bookroom-contents">
      <p id="bookroom-name">{{ bookroom.name | default("ブックルームの名前") }}</p>
        <p id="bookroom-description">{{bookroom.description | default("ブックルームの詳細") }}</p>
      </div>
      {% if bookroom.description is not none %}
      <span class="memo-category">
          仮タグ
        </span>
      
     {% endif %} {% if uid == bookroom.user_id %}
      <button class="update-bookroom-button"id="update-bookroom-modal"label="更新">
        <img src="{{ url_for('static', filename='img/pen.png') }}" alt="アイコン" >
      </button>
     {% include 'modal/update-bookroom.html' %} {% endif %}
      </div>
    </div>  
    <div id="message-area">
      {% if messages|length > 0 %} {% for message in messages %} {% if
      message.user_id == uid %}
      <div class="my-messages">
  
    <form action="/public_bookrooms/{{ bookroom.id }}/messages/{{ message.id }}" method="POST">
      <input type="hidden" name="_method" value="DELETE"> 
      
      <div class="message-and-reaction-right">
        <p class="box box-right">{{ message.message }}
        <span class="timestamp timestamp-right">2025/10/28 16:54</span>
        </p>
        <div class="reaction-icon-wrapper reaction-icon-left">
           <img src="{{ url_for('static', filename='#') }}" alt="reaction" class="reaction-icon">
        </div>
      </div> 
      
      <button type="submit" class="delete-message-button">
        <img src="{{ url_for('static', filename='img/trash-can.png') }}" alt="アイコン" >
      </button>
    </form> 
    </div>
      {% else %}
      <div class="messages">
        <p class="user-name">{{message.user_name | default("メッセージテーブルのユーザーネーム")}}</p>
        <div class="message-and-reaction-left">
        <p class="box box-left">{{message.message| default("メッセージテーブルの内容")}}
        <span class="timestamp timestamp-left">2025/10/28 16:54</span>
        </p>
        <div class="reaction-icon-wrapper reaction-icon-right">
           <img src="{{ url_for('static', filename='#') }}" alt="reaction" class="reaction-icon">
          </div>
        </div>  
      </div>
      {% endif %} {% endfor %} {% else %}
      <p id="no-message">まだメッセージがありません</p>
      {% endif %}
    </div>
    <div class="typing-box-wrapper">
      <form class="typing-box" method="POST" name="newMessageForm">
        <textarea name="message" id="message" autofocus></textarea>
        <input type="hidden" name="bookroom_id" value="{{bookroom.id}}" />
        <button type="submit" id="add-message-button">
          <img src="{{ url_for('static', filename='img/pen.png') }}" alt="アイコン" />
        </button>
      </form>
    </div>
</div>
{% endblock %} {% block script %}
<script type="text/javascript">
  // prettier-ignore
  const uid = JSON.parse('{{ uid|tojson }}');
</script>
<script
  src="{{url_for('static',filename='js/scroll-message.js')}}"
  type="text/javascript"
></script>
<script
  src="{{url_for('static',filename='js/channels/update-channel.js')}}"
  type="text/javascript"
></script>
{% endblock %}
