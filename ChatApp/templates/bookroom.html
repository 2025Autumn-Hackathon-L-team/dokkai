{% extends 'base.html' %} 

{% block title %}
<title>public-bookroom</title>
{% endblock %} 

{% block body %}
<div class="main-container">
  <div class="bookroom-title">
    <h1>PUBLIC BOOKROOM</h1> {# Header title changed to "Memo" #}
  </div>

  {# Category selection dropdown #}
  <div class="category-select-wrapper">
    <select name="category" id="category-filter">
      <option value="">カテゴリを選択</option>
      <option value="idea">小説</option>
      <option value="todo">ノンフィクション</option>
      <option value="shopping">雑誌</option>
      <option value="uncategorized">未分類</option>
    </select>
  </div>

  <div id="bookroom-list"> {# This is the container for the memo list #}
    {# CSS is set to hide existing "Channel name" and "Channel description" headers #}
    
    {% for bookroom in bookrooms %}
    <div class="memo-item-card"> {# Card for each memo #}
      <div class="memo-content">
        <h3 class="memo-title">{{ bookroom.name }}</h3>
        <p class="memo-description">{{ bookroom.description }}</p>
      </div>
      <div class="memo-meta">
        {# Date and category data will come from Python or be dummy data #}
        <span class="memo-date">2018/09/12 10:55</span>
        <span class="memo-category {{ bookroom.category_tag | default('uncategorized') }}">
          {{ bookroom.category | default('未分類') }}
        </span>
      </div>
      <div class="memo-icon">
        <!-- Place character icon here (set the correct image path) --><img src="{{ url_for('static', filename='img/character_icon_pink.png') }}" alt="アイコン" />
      </div>
    </div>
    {% endfor %}

    {# ul.bookroom-box for pagination remains if needed #}
    <ul class="bookroom-box">
      <!-- Pagination elements go here --></ul>
  </div>

  {# Floating Action Button #}
  <button class="fab-button">
    <ion-icon name="create-outline"></ion-icon> {# Pen icon #}
  </button>
  
  <div id="footer">
    <p id="footer-text">DOKKAI</p>
  </div>
  {% include 'modal/create-bookroom.html' %} 
  {% include 'modal/delete-bookroom.html' %}
</div>
{% endblock %} 

{% block script %}
<script type="text/javascript">
  // prettier-ignore
  // Ensure the variable name matches what's passed from Python (bookrooms)
  // Added | default to prevent JSON serialization errors if data is missing.
  const bookrooms = JSON.parse('{{ bookrooms|tojson | default("[]") }}'); 
  // prettier-ignore
  const uid = JSON.parse('{{ uid|tojson | default("null") }}');
</script>
<script
  src="{{url_for('static',filename='js/bookroom/create-bookroom.js')}}"
  type="module"
></script>
<script
  src="{{url_for('static',filename='js/bookroom/delete-bookroom.js')}}"
  type="module"
></script>
{% endblock %}
