{% extends 'base.html' %} 

{% block title %}
<title>public-bookroom</title>
{% endblock %} 

{% block body %}
<div class="main-container">
  <div class="bookroom-title">
    <h1>PUBLIC BOOKROOM</h1> 
  </div>
  <div class="search-trigger-container search-form-5" id="search-button">
    <label>
        <input type="text" readonly name="q" placeholder="PUBLICの中でさがす">
    </label>
    <button type="button" aria-label="検索"></button>
</div>

  <div id="bookroom-list"> 
    {% for bookroom in paginated_bookrooms %}
    <div class="room-item-card"> {# Card for each memo #}
      <div class="room-content">
        <a href="{{ url_for('detail', bookroom_id=bookroom.id) }}" class="bookroom-to-message">
        <h3 class="room-title">{{ bookroom.name }}</h3>
        <p class="room-description">{{ bookroom.description }}</p>
        </a>
          <div class="tag-data mobileonly">
          {% if pagenated_bookroom_tag.get(bookroom.id) %}
            {% for tag in pagenated_bookroom_tag[bookroom.id][:4] %}
              <span class="room-category"> {{ tag }} </span>
            {% endfor %}
          {% endif %}
          </div>
        </span>
      </div>
      <div class="room-group">
        <span class="room-date">{{ bookroom.updated_at.strftime('%Y/%m/%d %H:%M') }}</span>
          <div class="tag-data desktoponly">
          {% if pagenated_bookroom_tag.get(bookroom.id) %}
            {% for tag in pagenated_bookroom_tag[bookroom.id][:4] %}
              <span class="room-category"> {{ tag }} </span>
            {% endfor %}
          {% endif %}
          </div>
        </span>
      </div>
      <div class="reaction-icon">
        {% if session.get('user_id') == bookroom.user_id %}
         <button class="delete-bookroom-trigger" data-bookroom-id="{{ bookroom.id }}">
        <img src="{{ url_for('static', filename='img/trash-can.png') }}" alt="アイコン" >
         </button>
        {% endif %}
      </div>
    </div> 
    {% endfor %}
    {% include 'modal/search_public.html'%}

    <div class="pagination-container">
      {{ pagination.info }}
      {{ pagination.links }}
    </div>
  </div>

  {# Floating Action Button #}
  <button class="create-bookroom-button"id="create-bookroom-button"label="作成">
     MAKE
  </button>
  {% include 'modal/create-bookroom.html' %} 
  {% include 'modal/delete-bookroom.html' %}
</div>
{% endblock %} 

{% block script %}
<script type="text/javascript">
  // prettier-ignore
  const bookrooms = JSON.parse('{{ paginated_bookrooms|tojson }}'); 
  // prettier-ignore
  const uid = JSON.parse('{{ uid|tojson }}');
  const IS_PUBRIC = true;
</script>
<script
  src="{{url_for('static',filename='js/bookroom/create-bookroom.js')}}"
  type="module"
></script>
<script
  src="{{url_for('static',filename='js/bookroom/delete-bookroom.js')}}"
  type="module"
></script>
<script
  src="{{url_for('static',filename='js/bookroom/search.js')}}"
  type="module"
></script>
{% endblock %}
